<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Derivatives w.r.t. electric field (qcip_tools.derivatives_e) &mdash; qcip_tools 0.6.9 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Excitations (qcip_tools.derivatives_exci)" href="derivatives_exci.html" />
    <link rel="prev" title="Derivatives of the energy (qcip_tools.derivatives)" href="derivatives.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> qcip_tools
          </a>
              <div class="version">
                0.6.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing qcip_tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../code-documentation.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="atom.html">Atom (<code class="docutils literal notranslate"><span class="pre">qcip_tools.atom</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="basis_set.html">Basis set (<code class="docutils literal notranslate"><span class="pre">qcip_tools.basis_set</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bounding.html">Bounding objects(<code class="docutils literal notranslate"><span class="pre">qcip_tools.bounding</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="chemistry_files.html">Chemistry files (<code class="docutils literal notranslate"><span class="pre">qcip_tools.chemistry_files</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="derivatives.html">Derivatives of the energy (<code class="docutils literal notranslate"><span class="pre">qcip_tools.derivatives</span></code>)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Derivatives w.r.t. electric field (<code class="docutils literal notranslate"><span class="pre">qcip_tools.derivatives_e</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#theory">Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sources">Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-qcip_tools.derivatives_e">API documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="derivatives_exci.html">Excitations (<code class="docutils literal notranslate"><span class="pre">qcip_tools.derivatives_exci</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="derivatives_g.html">Derivatives w.r.t. geometrical stuffs (<code class="docutils literal notranslate"><span class="pre">qcip_tools.derivatives_g</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="math.html">Math helpers (<code class="docutils literal notranslate"><span class="pre">qcip_tools.math</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mixins.html">Mixins (<code class="docutils literal notranslate"><span class="pre">qcip_tools.mixins</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="molecule.html">Molecule (<code class="docutils literal notranslate"><span class="pre">qcip_tools.molecule</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="numerical_differentiation.html">Numerical differentiation (<code class="docutils literal notranslate"><span class="pre">qcip_tools.numerical_differentiation</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quantities.html">Quantities (<code class="docutils literal notranslate"><span class="pre">qcip_tools.quantities</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="symmetry.html">Symmetry (<code class="docutils literal notranslate"><span class="pre">qcip_tools.symmetry</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="transformations.html">Transformations (<code class="docutils literal notranslate"><span class="pre">qcip_tools.transformations</span></code>)</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">qcip_tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../code-documentation.html">API documentation</a> &raquo;</li>
      <li>Derivatives w.r.t. electric field (<code class="docutils literal notranslate"><span class="pre">qcip_tools.derivatives_e</span></code>)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/code-documentation/derivatives_e.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="derivatives-w-r-t-electric-field-qcip-tools-derivatives-e">
<h1>Derivatives w.r.t. electric field (<code class="docutils literal notranslate"><span class="pre">qcip_tools.derivatives_e</span></code>)<a class="headerlink" href="#derivatives-w-r-t-electric-field-qcip-tools-derivatives-e" title="Permalink to this headline"></a></h1>
<p>Tools to help the manipulation of derivatives of the energy with respect to a static (<code class="docutils literal notranslate"><span class="pre">F</span></code>) or dynamic (<code class="docutils literal notranslate"><span class="pre">D</span></code>) electric field (though the first one is a special case of the second).</p>
<div class="math notranslate nohighlight">
\[\newcommand{\sbb}[2]{\beta_{#1}\,\beta_{#2}}
\newcommand{\sgg}[2]{\gamma_{#1}\,\gamma_{#2}}\]</div>
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Permalink to this headline"></a></h2>
<p>Light can be described as an electromagnetic radiation, with time and space varying components.
Generally, only the phenomena associated with its electric components, because dominant, are considered.
If the space-dependent term is left constant, the electric part of the field reads</p>
<div class="math notranslate nohighlight">
\[\mathbf{f}_i(\omega) = \mathbf{f}^0_i\,(e^{-i\omega t} + e^{i\omega t}),\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{f}^0\)</span> is the amplitude of the the electric field, <span class="math notranslate nohighlight">\(\omega\)</span> is the pulsation (equals to <span class="math notranslate nohighlight">\(2\pi\nu\)</span>, with <span class="math notranslate nohighlight">\(\nu\)</span> the frequency in <span class="math notranslate nohighlight">\(s^{-1}\)</span>) and <span class="math notranslate nohighlight">\(t\)</span> the time (in <span class="math notranslate nohighlight">\(s\)</span>).
This situation refers to the <em>electric dipole approximation</em>.</p>
<p>A material is an ensemble of particles, negatively (electrons) and positively (nuclei) charged. An oscillating electric field interacts with all particles, though the motion of the electrons is the most significant part (because nuclei  have a smaller speed).
This leads to an oscillating induced dipole moment, or, at the macroscopic scale, a (change of) polarization. The total dipole of a molecule (sum of the induced and permanent dipole, <span class="math notranslate nohighlight">\(\vec{\mu}_0\)</span>), can be described using a Taylor series. For the <span class="math notranslate nohighlight">\(i\)</span>-components of the dipole moment,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mu_i = \mu^0_i &amp;+ \sum^{xyz}_j \alpha_{ij}(-\omega_{\sigma};\omega_1)\,\mathbf{f}_{j}(\omega_1) \nonumber\\
&amp;+ \frac{1}{2!} \sum^{xyz}_{jk} \beta_{ijk}(-\omega_{\sigma};\omega_1,\omega_2)\,\mathbf{f}_{j}(\omega_1)\,\mathbf{f}_{k}(\omega_2) \nonumber\\
&amp;+ \frac{1}{3!} \sum^{xyz}_{jkl} \gamma_{ijkl}(-\omega_{\sigma};\omega_1,\omega_2,\omega_3)\,\mathbf{f}_{j}(\omega_1)\,\mathbf{f}_{k}(\omega_2)\,\mathbf{f}_{l}(\omega_3)+ \ldots
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> are tensors of rank 2 and 3, called the polarizability and the first hyperpolarizability, respectively (generaly expressed in atomic units, <em>au</em>).
<span class="math notranslate nohighlight">\(\omega_1\)</span>, <span class="math notranslate nohighlight">\(\omega_2\)</span> and <span class="math notranslate nohighlight">\(\omega_3\)</span> are the pulsations of the fields applied in the <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span> and  <span class="math notranslate nohighlight">\(l\)</span> directions, while <span class="math notranslate nohighlight">\(\omega_\sigma = \sum_i \omega_i\)</span>.
For small electric fields, the polarizability term is dominant, but the hyperpolarizability terms becomes non-negligible when the field gets large.</p>
</section>
<section id="sources">
<h2>Sources<a class="headerlink" href="#sources" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>R.W. Boyd,  « Nonlinear Optics (3rd edition) ». <em>Elsevier</em> (2008).</p></li>
<li><p>F. Castet <em>et al</em>. <em>J. Chem. Phys.</em> <strong>136</strong>, 024506 (2012).</p></li>
<li><p>F. Castet <em>et al</em>. <em>Acc. Chem. Res.</em> <strong>46</strong>, 2656 (2013).</p></li>
</ul>
</section>
<section id="module-qcip_tools.derivatives_e">
<span id="api-documentation"></span><h2>API documentation<a class="headerlink" href="#module-qcip_tools.derivatives_e" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.BaseElectricalDerivativeTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">BaseElectricalDerivativeTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'static'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.BaseElectricalDerivativeTensor" title="Permalink to this definition"></a></dt>
<dd><p>Base for all derivatives of the energy with respect to the electric field.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.BaseElectricalDerivativeTensor.rank">
<span class="sig-name descname"><span class="pre">rank</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.BaseElectricalDerivativeTensor.rank" title="Permalink to this definition"></a></dt>
<dd><p>Alias for the order</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.BaseElectricalDerivativeTensor.response_to_electric_field">
<span class="sig-name descname"><span class="pre">response_to_electric_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.BaseElectricalDerivativeTensor.response_to_electric_field" title="Permalink to this definition"></a></dt>
<dd><p>Response to an electric field, located at the (0, 0, 0) position and for which the direction is given
by <code class="docutils literal notranslate"><span class="pre">field</span></code>.</p>
<div class="math notranslate nohighlight">
\[E_i = \sum_{ij\ldot}^{x,y,z} \chi_{ij\ldots}\,F_i\,F_j\,\ldots\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>field</strong> (<em>numpy.array</em>) – The electric field</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.BaseElectricalDerivativeTensor.to_name">
<span class="sig-name descname"><span class="pre">to_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simplified</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.BaseElectricalDerivativeTensor.to_name" title="Permalink to this definition"></a></dt>
<dd><p>Get the name of the tensor from its representation, by using <code class="docutils literal notranslate"><span class="pre">REPRESENTATION</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.BaseElectricalDerivativeTensor.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.BaseElectricalDerivativeTensor.to_string" title="Permalink to this definition"></a></dt>
<dd><p>Rewritten to get a better output with this kind of tensor</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.ElectricDipole">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">ElectricDipole</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dipole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.ElectricDipole" title="Permalink to this definition"></a></dt>
<dd><p>Dipole moment, commonly written <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.ElectricDipole.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.ElectricDipole.norm" title="Permalink to this definition"></a></dt>
<dd><p>Norm of the dipole</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.ElectricDipole.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_extras</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.ElectricDipole.to_string" title="Permalink to this definition"></a></dt>
<dd><p>Rewritten to add information</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">FirstHyperpolarisabilityTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'static'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor" title="Permalink to this definition"></a></dt>
<dd><p>First hyperpolarisability  tensor, commonly written <span class="math notranslate nohighlight">\(\beta(-\omega_\sigma;\omega_1,\omega_2)\)</span>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_hrs">
<span class="sig-name descname"><span class="pre">beta_hrs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_hrs" title="Permalink to this definition"></a></dt>
<dd><p>Hyper-Rayleigh scattering quantity:</p>
<div class="math notranslate nohighlight">
\[\beta_{HRS}=\sqrt{\langle\beta^2_{ZZZ}\rangle + \langle\beta^2_{ZXX}\rangle}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_kerr">
<span class="sig-name descname"><span class="pre">beta_kerr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dipole</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_kerr" title="Permalink to this definition"></a></dt>
<dd><p>Measured quantity in a dc-Kerr <span class="math notranslate nohighlight">\(\beta(-\omega;\omega,0)\)</span> experiment.</p>
<div class="math notranslate nohighlight">
\[\beta^K = \frac{3}{2}\,(\beta_{||}-\beta_{\perp})\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dipole</strong> (<em>numpy.ndarray</em>) – dipole moment</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>beta dc-Kerr</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_parallel">
<span class="sig-name descname"><span class="pre">beta_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dipole</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_parallel" title="Permalink to this definition"></a></dt>
<dd><p>Fetch beta value under parallel polarization of all fields:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\beta_{||} &amp;= \frac{1}{5}\,\sum_i
\frac{\mu_i}{||\vec{\mu}||}\,\sum_{j} \beta_{ijj}
+ \beta_{jij} + \beta_{jji} \\
&amp;= \frac{3}{5}\,\sum_i\frac{\mu_i\,\beta_{i}}{||\vec{\mu}||}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta_{i}\)</span> is a component of the beta “tensor”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dipole</strong> (<em>numpy.ndarray</em><em>|</em><a class="reference internal" href="#qcip_tools.derivatives_e.ElectricDipole" title="qcip_tools.derivatives_e.ElectricDipole"><em>qcip_tools.derivatives_e.ElectricDipole</em></a>) – dipole moment of the molecule</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_perpendicular">
<span class="sig-name descname"><span class="pre">beta_perpendicular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dipole</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_perpendicular" title="Permalink to this definition"></a></dt>
<dd><p>Fetch beta value under perpendicular polarization of optical and static field.</p>
<div class="math notranslate nohighlight">
\[\beta_{\perp} = \frac{1}{5}\,\sum_i
\frac{\mu_i}{||\vec{\mu}||}\,\sum_{j} 2\beta_{ijj} - 3\beta_{jij} + 2 \beta_{jji}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dipole</strong> (<em>numpy.ndarray</em><em>|</em><a class="reference internal" href="#qcip_tools.derivatives_e.ElectricDipole" title="qcip_tools.derivatives_e.ElectricDipole"><em>qcip_tools.derivatives_e.ElectricDipole</em></a>) – the dipole moment</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_squared_zxx">
<span class="sig-name descname"><span class="pre">beta_squared_zxx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_squared_zxx" title="Permalink to this definition"></a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(\langle\beta^2_{ZXX}\rangle\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\langle\beta^2_{ZXX}\rangle
&amp;= \frac{1}{105}\,
\sum_{ijk}^{xyz} 6\,\beta_{ijk}^2
+ 3\,\beta_{ijj} \beta_{ikk}
-2\, (\beta_{iij} \beta_{jkk} +\beta_{iij} \beta_{kjk}  +\beta_{ijk} \beta_{jik})\\
&amp;\approx \frac{1}{105}\,\sum_{ijk}^{xyz}4\, \beta_{ijk}^2-\beta_{ijj} \beta_{ikk}
\end{align}\end{split}\]</div>
<p>(actually computed using the polarization dependant intensity)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_squared_zzz">
<span class="sig-name descname"><span class="pre">beta_squared_zzz</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_squared_zzz" title="Permalink to this definition"></a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(\langle\beta^2_{ZZZ}\rangle\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\langle\beta^2_{ZZZ}\rangle
&amp;= \frac{1}{105}\,\sum_{ijk}^{xyz} 2\,
\beta_{ijk}^2 + \beta_{ijj} \beta_{ikk}
+ 4\, (\beta_{iij} \beta_{jkk}
+ \beta_{iij} \beta_{kjk} + \beta_{ijk} \beta_{jik})\\
&amp;\approx \frac{1}{35}\,\sum_{ijk}^{xyz} 2\,\beta_{ijk}^2 + 3 \beta_{ijj} \beta_{ikk}
\end{align}\end{split}\]</div>
<p>(actually computed using the polarization dependant intensity)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_vector">
<span class="sig-name descname"><span class="pre">beta_vector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.beta_vector" title="Permalink to this definition"></a></dt>
<dd><p>return the hyperpolarizability vector</p>
<div class="math notranslate nohighlight">
\[\beta_i = \frac{1}{3} \sum_j \beta_{ijj} + \beta_{jij} + \beta_{jji}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.compute_sum">
<span class="sig-name descname"><span class="pre">compute_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.compute_sum" title="Permalink to this definition"></a></dt>
<dd><p>Shorthand to simplify the computation of invariant quantities.
<code class="docutils literal notranslate"><span class="pre">what</span></code> is the list of quantities to compute:
<code class="docutils literal notranslate"><span class="pre">beta_tensor.compute_sum([(2/5,</span> <span class="pre">'ijjikk'),</span> <span class="pre">(3/5,</span> <span class="pre">'iijkjk'])</span></code> is equivalent to</p>
<div class="math notranslate nohighlight">
\[\sum_{ijk}^{xyz} \frac{2}{5}\,\sbb{ijj}{ijj} + \frac{2}{5}\,\sbb{iij}{kjk}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>what</strong> (<em>list</em>) – what to compute ? list of tuple of the form (fraction, string of 6 char  [either i, j or k])</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.depolarization_ratio">
<span class="sig-name descname"><span class="pre">depolarization_ratio</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.depolarization_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Hyper-Rayleigh depolarization ratio:</p>
<div class="math notranslate nohighlight">
\[DR = \frac{\langle\beta^2_{ZZZ}\rangle}{\langle\beta^2_{XZZ}\rangle}\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.dipolar_contribution">
<span class="sig-name descname"><span class="pre">dipolar_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.dipolar_contribution" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.dipolar_contribution_squared">
<span class="sig-name descname"><span class="pre">dipolar_contribution_squared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.dipolar_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the square of the dipolar contribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.is_shg">
<span class="sig-name descname"><span class="pre">is_shg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.is_shg" title="Permalink to this definition"></a></dt>
<dd><p>Check if the tensor correspond to a SHG one</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.nonlinear_anisotropy">
<span class="sig-name descname"><span class="pre">nonlinear_anisotropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.nonlinear_anisotropy" title="Permalink to this definition"></a></dt>
<dd><p>Compute the nonlinear anisotropy:</p>
<div class="math notranslate nohighlight">
\[\rho_{3/1}^2 = \frac{|\beta_{J=3}|^2}{|\beta_{J=1}|^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.octupolar_contribution">
<span class="sig-name descname"><span class="pre">octupolar_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.octupolar_contribution" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.octupolar_contribution_squared">
<span class="sig-name descname"><span class="pre">octupolar_contribution_squared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.octupolar_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the square of the octupolar contribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.polarization_angle_dependant_intensity">
<span class="sig-name descname"><span class="pre">polarization_angle_dependant_intensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.polarization_angle_dependant_intensity" title="Permalink to this definition"></a></dt>
<dd><p>Compute the angle (<span class="math notranslate nohighlight">\(\Psi\)</span>) dependant intensity in the SHS setup.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\langle\beta^2\rangle = \frac{1}{105}\,\begin{pmatrix}
4-26\cos^2\Psi+20\cos^4\Psi\\
4+2\cos^2\Psi-8\cos^4\Psi \\
1-10\cos^2\Psi+12\cos^4\Psi \\
2+8\cos^2\Psi-4\cos^4\Psi \\
4+2\cos^2\Psi-8\cos^4\Psi
\end{pmatrix}^T\,\begin{pmatrix}
[g\beta^2]_A\\
[g\beta^2]_B\\
[g\beta^2]_C\\
[g\beta^2]_D\\
[g\beta^2]_E\\
\end{pmatrix}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>angle</strong> (<em>float</em>) – angle (in <strong>degree</strong>)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J1_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J1_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J1_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Compute the <span class="math notranslate nohighlight">\(|\beta_{J=1}|^2\)</span> contribution</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[\begin{align}
|\beta_{J=1}|^2 &amp;= |\beta_{J=1\alpha}|^2 + |\beta_{J=1\beta}|^2 + 2\,|\beta_{J=1\alpha\beta}|^2
 &amp;= \frac{1}{5}\,\sum_{ijk}^{xyz} 2\,\sbb{ijj}{ikk} + 3\,\sbb{iij}{kjk} - 2\,\sbb{iij}{jkk}
\end{align}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J1a_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J1a_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J1a_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Compute the <span class="math notranslate nohighlight">\(|\beta_{J=1\alpha}|^2\)</span> contribution</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[|\beta_{J=1\alpha}|^2 = \frac{1}{5}\,\sum_{ijk}^{xyz} 2\,\sbb{ijj}{ikk}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J1ab_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J1ab_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J1ab_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Compute the <span class="math notranslate nohighlight">\(|\beta_{J=1\alpha\beta}|^2\)</span> contribution</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[|\beta_{J=1\alpha\beta}|^2 = -\frac{1}{5}\,\sum_{ijk}^{xyz}  \sbb{iij}{jkk}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J1b_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J1b_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J1b_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Compute the <span class="math notranslate nohighlight">\(|\beta_{J=1\beta}|^2\)</span> contribution</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[|\beta_{J=1\beta}|^2 = \frac{1}{5}\,\sum_{ijk}^{xyz} 3\,\sbb{iij}{kjk}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J2_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J2_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J2_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Compute the <span class="math notranslate nohighlight">\(|\beta_{J=2}|^2\)</span> contribution</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[|\beta_{J=2}|^2 = \frac{1}{3}\,\sum_{ijk}^{xyz} 2\beta_{ijk}^2 -2\,\sbb{ijk}{jik}-\sbb{ijj}{ikk}
-\,\sbb{iij}{kjk} +2\,\sbb{iij}{jkk}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J3_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J3_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.spherical_J3_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Compute the <span class="math notranslate nohighlight">\(|\beta_{J=3}|^2\)</span> contribution</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[|\beta_{J=3}|^2 =
\frac{1}{15}\,\sum_{ijk}^{xyz} 5\beta_{ijk}^2
+ 10\,\sbb{ijk}{jik}-\sbb{ijj}{ikk} -4\,\sbb{iij}{kjk} -4\,\sbb{iij}{jkk}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_extras</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.FirstHyperpolarisabilityTensor.to_string" title="Permalink to this definition"></a></dt>
<dd><p>Rewritten to add information</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.NotSHG">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">NotSHG</span></span><a class="headerlink" href="#qcip_tools.derivatives_e.NotSHG" title="Permalink to this definition"></a></dt>
<dd><p>Raised when trying to compute a quantity from SHG experiment on a tensor which is not</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.NotTHG">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">NotTHG</span></span><a class="headerlink" href="#qcip_tools.derivatives_e.NotTHG" title="Permalink to this definition"></a></dt>
<dd><p>Raised when trying to compute a quantity from THG experiment on a tensor which is not</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.PolarisabilityTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">PolarisabilityTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'static'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.PolarisabilityTensor" title="Permalink to this definition"></a></dt>
<dd><p>Polarisability  tensor, commonly written <span class="math notranslate nohighlight">\(\alpha(-\omega_\sigma;\omega_1)\)</span>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.PolarisabilityTensor.anisotropic_value">
<span class="sig-name descname"><span class="pre">anisotropic_value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.PolarisabilityTensor.anisotropic_value" title="Permalink to this definition"></a></dt>
<dd><p>Ansotropic value:</p>
<div class="math notranslate nohighlight">
\[\Delta\alpha=
\left[\frac{1}{2}\sum_{ij} 3\,\alpha_{ij}^2 - \alpha_{ii}\,\alpha_{jj}\right]^{1/2}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.PolarisabilityTensor.isotropic_value">
<span class="sig-name descname"><span class="pre">isotropic_value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.PolarisabilityTensor.isotropic_value" title="Permalink to this definition"></a></dt>
<dd><p>Isotropic value:</p>
<div class="math notranslate nohighlight">
\[\bar{\alpha}=\frac{1}{3}\sum_i \alpha_{ii}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.PolarisabilityTensor.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_extras</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.PolarisabilityTensor.to_string" title="Permalink to this definition"></a></dt>
<dd><p>Rewritten to add information</p>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.REPRESENTATIONS">
<span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">REPRESENTATIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha(-w;w)':</span> <span class="pre">'dD',</span> <span class="pre">'alpha(0;0)':</span> <span class="pre">'FF',</span> <span class="pre">'beta(-2w;w,w)':</span> <span class="pre">'XDD',</span> <span class="pre">'beta(-w;w,0)':</span> <span class="pre">'dDF',</span> <span class="pre">'beta(0;0,0)':</span> <span class="pre">'FFF',</span> <span class="pre">'beta(0;w,-w)':</span> <span class="pre">'FDd',</span> <span class="pre">'gamma(-2w;w,w,0)':</span> <span class="pre">'XDDF',</span> <span class="pre">'gamma(-3w;w,w,w)':</span> <span class="pre">'XDDD',</span> <span class="pre">'gamma(-w;0,0,w)':</span> <span class="pre">'dFFD',</span> <span class="pre">'gamma(-w;w,0,0)':</span> <span class="pre">'dDFF',</span> <span class="pre">'gamma(-w;w,w,-w)':</span> <span class="pre">'dDDd',</span> <span class="pre">'gamma(0;0,0,0)':</span> <span class="pre">'FFFF',</span> <span class="pre">'mu':</span> <span class="pre">'F'}</span></em><a class="headerlink" href="#qcip_tools.derivatives_e.REPRESENTATIONS" title="Permalink to this definition"></a></dt>
<dd><p>Correspondence between a name and a representation</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SIMPLIFIED_NAMES">
<span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">SIMPLIFIED_NAMES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">'α(0;0)',</span> <span class="pre">'alpha(-w;w)':</span> <span class="pre">'α(-w;w)',</span> <span class="pre">'beta':</span> <span class="pre">'β(0;0,0)',</span> <span class="pre">'beta(-2w;w,w)':</span> <span class="pre">'β(-2w;w,w)',</span> <span class="pre">'beta(-w;w,0)':</span> <span class="pre">'β(-w;w,0)',</span> <span class="pre">'energy':</span> <span class="pre">'E',</span> <span class="pre">'gamma':</span> <span class="pre">'γ(0;0,0,0)',</span> <span class="pre">'gamma(-2w;w,w,0)':</span> <span class="pre">'γ(-2w;w,w,0)',</span> <span class="pre">'gamma(-3w;w,w,w)':</span> <span class="pre">'γ(-3w;w,w,w)',</span> <span class="pre">'gamma(-w;0,0,w)':</span> <span class="pre">'γ(-w;0,0,w)',</span> <span class="pre">'gamma(-w;w,0,0)':</span> <span class="pre">'γ(-w;0,0,w)',</span> <span class="pre">'gamma(-w;w,w,-w)':</span> <span class="pre">'γ(-w;w,w,-w)',</span> <span class="pre">'mu':</span> <span class="pre">'µ'}</span></em><a class="headerlink" href="#qcip_tools.derivatives_e.SIMPLIFIED_NAMES" title="Permalink to this definition"></a></dt>
<dd><p>List of all simplified names</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">SecondHyperpolarizabilityTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'static'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor" title="Permalink to this definition"></a></dt>
<dd><p>Second hyperpolarisability  tensor, commonly written
<span class="math notranslate nohighlight">\(\gamma(-\omega_\sigma;\omega_1,\omega_2,\omega_3)\)</span>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.compute_sum">
<span class="sig-name descname"><span class="pre">compute_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.compute_sum" title="Permalink to this definition"></a></dt>
<dd><p>Shorthand to simplify the computation of invariant quantities.
<code class="docutils literal notranslate"><span class="pre">what</span></code> is the list of quantities to compute:
<code class="docutils literal notranslate"><span class="pre">gamma_tensor.compute_sum([(2/5,</span> <span class="pre">'ijklijkl'),</span> <span class="pre">(3/5,</span> <span class="pre">'iijjkkll'])</span></code> is equivalent to</p>
<div class="math notranslate nohighlight">
\[\sum_{ijk}^{xyz} \frac{2}{5}\,\sgg{ijkl}{ijkl} + \frac{2}{5}\,\sgg{iijj}{kkll}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>what</strong> (<em>list</em>) – what to compute ? list of tuple of the form (fraction, string of 8 char  [either i, j, k or l])</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.depolarization_ratio">
<span class="sig-name descname"><span class="pre">depolarization_ratio</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.depolarization_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Compute the depolarization ratio:</p>
<div class="math notranslate nohighlight">
\[DR = \frac{\langle\gamma^2_{ZZZZ}\rangle}{\langle\gamma^2_{ZXXX}\rangle}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_kerr">
<span class="sig-name descname"><span class="pre">gamma_kerr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_kerr" title="Permalink to this definition"></a></dt>
<dd><p>Measured quantity in a dc-Kerr (-w;w,0,0) experiment</p>
<div class="math notranslate nohighlight">
\[\gamma^K = \frac{3}{2}\,(\gamma_{||}-\gamma_{\perp})\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_parallel">
<span class="sig-name descname"><span class="pre">gamma_parallel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_parallel" title="Permalink to this definition"></a></dt>
<dd><p>Fetch parallel isotropic average of gamma</p>
<div class="math notranslate nohighlight">
\[\gamma_{||} = \frac{1}{15}\,\sum_{ij} \gamma_{iijj} + \gamma_{ijji} + \gamma_{ijij}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_perpendicular">
<span class="sig-name descname"><span class="pre">gamma_perpendicular</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_perpendicular" title="Permalink to this definition"></a></dt>
<dd><p>Fetch perpendicular isotropic average of gamma</p>
<div class="math notranslate nohighlight">
\[\gamma_{\perp} = \frac{1}{15}\,\sum_{ij} 2\gamma_{iijj} - \gamma_{ijij}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_squared_zxxx">
<span class="sig-name descname"><span class="pre">gamma_squared_zxxx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_squared_zxxx" title="Permalink to this definition"></a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(\langle\gamma^2_{ZXXX}\rangle\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\langle\gamma_{ZXXX}^2\rangle &amp;=
\frac{1}{630}\sum_{ijkl}^{xyz} \left\{\begin{array}{l}
16\,\gamma_{ijkl}^2
+24\,\gamma_{ijjk} \gamma_{ikll}
- 12\,\gamma_{iijk} \gamma_{jllk}\\
 - 6\,(\gamma_{iijk} \gamma_{ljlk}
 + \gamma_{ijkl} \gamma_{jikl} )
 -3\,(\gamma_{iijj} \gamma_{kllk}+\gamma_{ijjk} \gamma_{kill})
\end{array}\right\}\\
&amp;\approx \frac{1}{630} \sum_{ijkl}^{xyz}
10\,\gamma^2_{ijkl} +3\,\gamma_{iijk}\gamma_{jkll}  -3\gamma_{iijj}\gamma_{kkll}\end{split}\]</div>
<p>(actually computed using the polarization dependant intensity)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_squared_zzzz">
<span class="sig-name descname"><span class="pre">gamma_squared_zzzz</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_squared_zzzz" title="Permalink to this definition"></a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(\langle\gamma^2_{ZZZZ}\rangle\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\langle\gamma_{ZZZZ}^2\rangle &amp;=
\frac{1}{315}\sum_{ijkl}^{xyz} \left\{\begin{array}{l}
2\,\gamma_{ijkl}^2
+ 12\,\gamma_{iijk} \gamma_{jllk}
+ 6\,(\gamma_{iijk} \gamma_{ljlk}
+ \gamma_{ijkl} \gamma_{jikl} )\\
+ 3\,(\gamma_{ijjk} \gamma_{ikll}
+\gamma_{iijj} \gamma_{kllk}
+\gamma_{ijjk} \gamma_{kill})
\end{array}\right\}\\
&amp;\approx \frac{1}{315}\,\sum_{ijkl}^{xyz}
8\,\gamma^2_{ijkl} + 24\, \gamma_{iijk}\gamma_{jkll}+3\,\gamma_{iijj}\gamma_{kkll}\end{split}\]</div>
<p>(actually computed using the polarization dependant intensity)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_ths">
<span class="sig-name descname"><span class="pre">gamma_ths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.gamma_ths" title="Permalink to this definition"></a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(\gamma_{THS}\)</span>, the quantity from a third harmonic scattering experiment.</p>
<div class="math notranslate nohighlight">
\[\gamma_{THS} = \sqrt{\langle\gamma^2_{ZZZZ}\rangle + \langle\gamma^2_{ZXXX}\rangle}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.hexadecapolar_contribution">
<span class="sig-name descname"><span class="pre">hexadecapolar_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.hexadecapolar_contribution" title="Permalink to this definition"></a></dt>
<dd><p>Compute the hexadecapolar contribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.hexadecapolar_contribution_squared">
<span class="sig-name descname"><span class="pre">hexadecapolar_contribution_squared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.hexadecapolar_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the square of the hexadecapolar (bless you!) contribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.is_thg">
<span class="sig-name descname"><span class="pre">is_thg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.is_thg" title="Permalink to this definition"></a></dt>
<dd><p>Check if a tensor is a THG one</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.isotropic_contribution">
<span class="sig-name descname"><span class="pre">isotropic_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.isotropic_contribution" title="Permalink to this definition"></a></dt>
<dd><p>Compute the isotropic contribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.isotropic_contribution_squared">
<span class="sig-name descname"><span class="pre">isotropic_contribution_squared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.isotropic_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the square of the isotropic contribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.polarization_angle_dependant_intensity">
<span class="sig-name descname"><span class="pre">polarization_angle_dependant_intensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.polarization_angle_dependant_intensity" title="Permalink to this definition"></a></dt>
<dd><p>Compute the angle (<span class="math notranslate nohighlight">\(\Psi\)</span>) dependant intensity in the THS setup.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\langle\gamma^2\rangle = \frac{1}{630}\,
\begin{pmatrix}
6-81\cos^2\Psi+198\cos^4\Psi-126\cos^6\Psi\\
24-108\cos^2\Psi-72\cos^4\Psi+144\cos^6\Psi\\
12+54\cos^2\Psi-90\cos^4\Psi+18\cos^6\Psi\\
6-54\cos^2\Psi+36\cos^4\Psi+36\cos^6\Psi\\
4+36\cos^2\Psi-12\cos^4\Psi-12\cos^6\Psi \\
6-81\cos^2\Psi+198\cos^4\Psi-126\cos^6\Psi\\
12+54\cos^2\Psi-90\cos^4\Psi+18\cos^6\Psi
\end{pmatrix}^T\,\begin{pmatrix}
[g\gamma^2]_A\\
[g\gamma^2]_B\\
[g\gamma^2]_C\\
[g\gamma^2]_D\\
[g\gamma^2]_E\\
[g\gamma^2]_F\\
[g\gamma^2]_G\\
\end{pmatrix}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>angle</strong> (<em>float</em>) – angle (in degree)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.quadrupolar_contribution">
<span class="sig-name descname"><span class="pre">quadrupolar_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.quadrupolar_contribution" title="Permalink to this definition"></a></dt>
<dd><p>Compute the quadrupolar contribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.quadrupolar_contribution_squared">
<span class="sig-name descname"><span class="pre">quadrupolar_contribution_squared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.quadrupolar_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the square of the quadrupolar contribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>old_version</strong> (<em>bool</em>) – Use the previous (with Kleinman’s conditions) version</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J0_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J0_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J0_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(|\gamma_{J=0}|^2\)</span> contribution:</p>
<div class="math notranslate nohighlight">
\[|\gamma_{J=0}|^2 = \frac{1}{5} \sum^{xyz}_{ijkl} \sgg{iijj}{kllk}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J1_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J1_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J1_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(|\gamma_{J=1}|^2\)</span> contribution:</p>
<div class="math notranslate nohighlight">
\[|\gamma_{J=1}|^2 = \frac{1}{10} \sum^{xyz}_{ijkl} 3\,\sgg{ijjk}{ikll} - 3\,\sgg{ijjk}{kill}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J2_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J2_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J2_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(|\gamma_{J=2}|^2\)</span> contribution:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
|\gamma_{J=2}|^2 &amp;=
|\gamma_{J=2\alpha}|^2 + |\gamma_{J=2\beta}|^2 + 2\,|\gamma_{J=2\alpha\beta}|^2 \\
&amp;= \frac{1}{14}\,\sum_{ijkl}^{xyz}
10\,\sgg{iijk}{ljlk}+5\,\sgg{ijjk}{kill}
+5\,\sgg{ijjk}{ikll}-8\,\sgg{iijk}{jllk}-4\,\sgg{iijj}{kllk}
\end{align}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J2a_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J2a_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J2a_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(|\gamma_{J=2\alpha}|^2\)</span> contribution:</p>
<div class="math notranslate nohighlight">
\[|\gamma_{J=2\alpha}|^2 =
\frac{1}{42}\,\sum_{ijkl}^{xyz} 15\,\sgg{ijjk}{kill}+15\,\sgg{ijjk}{ikll}-10\,\sgg{iijj}{kllk}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J2ab_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J2ab_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J2ab_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(|\gamma_{J=2\alpha\beta}|^2\)</span> contribution:</p>
<div class="math notranslate nohighlight">
\[|\gamma_{J=2\alpha\beta}|^2
=\frac{1}{21}\,\sum_{ijkl}^{xyz} 2\,\sgg{iijj}{kllk}-6\,\sgg{iijk}{jllk}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J2b_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J2b_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J2b_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(|\gamma_{J=2\beta}|^2\)</span> contribution:</p>
<div class="math notranslate nohighlight">
\[|\gamma_{J=2\beta}|^2 = \frac{1}{21} \sum_{ijkl}^{xyz} 15\,\sgg{iijk}{ljlk}-5\,\sgg{iijj}{kllk}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J3_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J3_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J3_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(|\gamma_{J=3}|^2\)</span> contribution:</p>
<div class="math notranslate nohighlight">
\[\begin{split}|\gamma_{J=3}|^2 = \frac{1}{20} \sum^{xyz}_{ijkl}\left\{
\begin{array}{l}
15\,\gamma_{ijkl}^2+20\,\sgg{iijk}{jllk}+\sgg{ijjk}{kill}\\
-10\,\sgg{iijk}{ljlk}-15\,\sgg{ijkl}{jikl}-11\sgg{ijjk}{ikll}
\end{array}
\right\}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J4_contribution_squared">
<span class="sig-name descname"><span class="pre">spherical_J4_contribution_squared</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.spherical_J4_contribution_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(|\gamma_{J=4}|^2\)</span> contribution:</p>
<div class="math notranslate nohighlight">
\[\begin{split}|\gamma_{J=4}|^2 = \frac{1}{140} \sum^{xyz}_{ijkl}\left\{
\begin{array}{l}
35\,\gamma_{ijkl}^2+105\,\sgg{ijkl}{jikl}+12\,\sgg{iijj}{kllk}\\
-60\,\sgg{iijk}{jllk}-30\,\sgg{iijk}{ljlk}-15\sgg{ijjk}{ikll}-15\sgg{ijjk}{kill}
\end{array}
\right\}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_extras</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.SecondHyperpolarizabilityTensor.to_string" title="Permalink to this definition"></a></dt>
<dd><p>Rewritten to add information</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.convert_energy_to">
<span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">convert_energy_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.convert_energy_to" title="Permalink to this definition"></a></dt>
<dd><p>Convert energy to something else</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e</strong> (<em>float</em>) – the energy (in atomic unit)</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – the unit (nm, ev, cm-1)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.convert_frequency_from_string">
<span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">convert_frequency_from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.convert_frequency_from_string" title="Permalink to this definition"></a></dt>
<dd><p>Convert the string value to the value in atomic units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> (<em>str</em><em>|</em><em>float</em>) – the string value</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qcip_tools.derivatives_e.fields_to_str">
<span class="sig-prename descclassname"><span class="pre">qcip_tools.derivatives_e.</span></span><span class="sig-name descname"><span class="pre">fields_to_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qcip_tools.derivatives_e.fields_to_str" title="Permalink to this definition"></a></dt>
<dd><p>Get the string representation of a series of fields and the response, such as “-3w;w,w,w”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>tuple</em>) – list of fields</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>representation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="derivatives.html" class="btn btn-neutral float-left" title="Derivatives of the energy (qcip_tools.derivatives)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="derivatives_exci.html" class="btn btn-neutral float-right" title="Excitations (qcip_tools.derivatives_exci)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Pierre Beaujean (University of Namur).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>